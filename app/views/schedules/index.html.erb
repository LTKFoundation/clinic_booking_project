<%= form_for(Schedule.new, url: doctor_gig_schedules_path(current_doctor.id,@gig.ids)) do |f| %>
	<div class="row">
	<div class="col s2 input-field">
		<input type="checkbox" id="cb_all_week" onchange='handleChange(this);'/>
		<label for="cb_all_week">Cả Tuần</label>
	</div>
	<div class="col s4 input-field">
		<label>Bắt đầu</label>
		<%= text_field :start_at, "start_at", class: "timepicker", placeholder: '', id:"start_all", onchange:"updateStartTime(this);"%>
	</div>
	<div class="col s4 input-field">
		<label >Kết thúc </label>
		<%= text_field :end_at, "end_at", class: "timepicker", placeholder: '', id:"end_all", onchange:"updateEndTime(this);"%>
	</div>
	</div>
	<% @days.each do |day|%>
		<div class="row">
		<%= f.fields_for :schedules do |data| %>

		<div class="col s2 input-field">
		<input type="checkbox" id=<%= "#{day[0]}" %>/>
		<label for=<%= "#{day[0]}" %>><%=day[1]%></label>
		<%= data.hidden_field :day, id:"#{day[0]}", value: "#{day[0]}" %>			
		</div>
		<div class="col s4 input-field">
			<label>Bắt đầu</label>
			<%= data.text_field :start_at, class: "timepicker", placeholder: '', id:"#{day[0]}_start"%>
		</div>
		<div class="col s4 input-field">
			<label >Kết thúc </label>
			<%= data.text_field :end_at, class: "timepicker", placeholder: '', id:"#{day[0]}_end" %>
		</div>
		<% end %>
		</div>	
	<% end %>


	<button class="btn waves-effect waves-light" type="submit" name="action">Tạo dịch vụ
		<i class="material-icons right">send</i>
	</button>
<% end %>
<script type="text/javascript">
//TODO @Tucq PLEASE MAKE ALL THE LABEL "FLY UP" WHEN THEIR VALUE WERE FILLED. 
//NOW THE LABEL JUST SIT THEIR ASSES RIGHT WHERE THE VALUE ARE FILLED
$(document).on('turbolinks:load', function() {
    $('.timepicker').pickatime({
      min: [07,00],
      max: [22,00]
    });
});
function updateAllStartTime()
{
	var start_all = $('input[id=start_all]').val();
	$('input[id$=start]').each(function () {
		this.value = start_all;
	});
}
function updateAllEndTime()
{
		var end_all = $('input[id=end_all]').val();
		$('input[id$=end]').each(function () {
		 this.value = end_all;
		});
}
function handleChange(cb) {
  if(cb.checked == true){
   $('input[type=checkbox]').each(function () {
		 this.checked = true;
		});
		updateAllStartTime();
		updateAllEndTime();
  }
	else {
		$('input[type=checkbox]').each(function () {
		 this.checked = false;
		});
	}
}
function updateStartTime(tb)
{
	var all_cb = $('input[id=cb_all_week]').is(':checked');
	if(all_cb == true)
	{
		updateAllStartTime();
	}
}
function updateEndTime(tb)
{
	var all_cb = $('input[id=cb_all_week]').is(':checked');
	if(all_cb == true)
	{
		updateAllEndTime();
	}
}
</script>
